[INFO] accelerate hooks removed -> merging on current devices (CPU/offload).
[INFO][rank 0] device_map summary: {0: 6, 1: 3, 2: 3, 3: 3, 4: 3, 5: 3, 6: 3, 7: 3, 'cpu': 37}
[INFO][rank 0] Attaching LoRA adapter from: /home/Competition2025/P10/shareP10/llm_project/adapters/P10U017/minqlora_out_loop_20250810_0226
Traceback (most recent call last):
  File "/home/Competition2025/P10/P10U029/merge_lora_to_16bit.py", line 376, in <module>
    main()
  File "/home/Competition2025/P10/P10U029/merge_lora_to_16bit.py", line 332, in main
    out_fp16, metrics_fp16, dev_summary, off_rank_dir, rank, world = merge_lora_to_16bit(
                                                                     ^^^^^^^^^^^^^^^^^^^^
  File "/home/Competition2025/P10/P10U029/merge_lora_to_16bit.py", line 200, in merge_lora_to_16bit
    model = PeftModel.from_pretrained(base,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Competition2025/P10/P10U029/.conda/envs/conda_env_lora_merge/lib/python3.11/site-packages/peft/peft_model.py", line 555, in from_pretrained
    load_result = model.load_adapter(
                  ^^^^^^^^^^^^^^^^^^^
  File "/home/Competition2025/P10/P10U029/.conda/envs/conda_env_lora_merge/lib/python3.11/site-packages/peft/peft_model.py", line 1388, in load_adapter
    dispatch_model(
  File "/home/Competition2025/P10/P10U029/.conda/envs/conda_env_lora_merge/lib/python3.11/site-packages/accelerate/big_modeling.py", line 355, in dispatch_model
    check_device_map(model, device_map)
  File "/home/Competition2025/P10/P10U029/.conda/envs/conda_env_lora_merge/lib/python3.11/site-packages/accelerate/utils/modeling.py", line 1611, in check_device_map
    invalid_keys = [k for k in device_map if k != "" and k not in all_module_names]
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not iterable